import numpy
import pandas as pd

# copy and paste arrays generated from data processing.js
dates = ["2020-03-31T04:00:00.000Z","2020-03-24T04:00:00.000Z","2020-03-17T04:00:00.000Z","2020-03-12T04:00:00.000Z","2020-03-03T05:00:00.000Z","2020-02-25T05:00:00.000Z","2020-02-18T05:00:00.000Z","2020-02-11T05:00:00.000Z","2020-02-04T05:00:00.000Z","2020-01-28T05:00:00.000Z","2020-01-14T05:00:00.000Z","2020-01-07T05:00:00.000Z","2019-12-14T05:00:00.000Z","2019-12-04T05:00:00.000Z","2019-11-26T05:00:00.000Z","2019-11-20T05:00:00.000Z","2019-11-13T05:00:00.000Z","2019-11-06T05:00:00.000Z","2019-10-30T04:00:00.000Z","2019-10-23T04:00:00.000Z","2019-10-16T04:00:00.000Z","2019-10-09T04:00:00.000Z","2019-10-02T04:00:00.000Z","2019-09-25T04:00:00.000Z","2019-09-19T04:00:00.000Z","2019-09-10T04:00:00.000Z","2019-09-03T04:00:00.000Z","2019-08-28T04:00:00.000Z","2019-08-21T04:00:00.000Z","2019-08-14T04:00:00.000Z","2019-08-08T04:00:00.000Z","2019-07-31T04:00:00.000Z","2019-07-24T04:00:00.000Z","2019-07-17T04:00:00.000Z","2019-07-10T04:00:00.000Z","2019-07-03T04:00:00.000Z","2019-06-26T04:00:00.000Z","2019-06-18T04:00:00.000Z","2019-06-12T04:00:00.000Z","2019-06-05T04:00:00.000Z","2019-05-29T04:00:00.000Z","2019-05-23T04:00:00.000Z","2019-05-16T04:00:00.000Z","2019-05-08T04:00:00.000Z","2019-05-01T04:00:00.000Z","2019-04-22T04:00:00.000Z","2019-04-16T04:00:00.000Z","2019-04-08T04:00:00.000Z","2019-04-01T04:00:00.000Z","2019-03-26T04:00:00.000Z","2019-03-19T04:00:00.000Z","2019-03-12T04:00:00.000Z","2019-03-05T05:00:00.000Z","2019-02-26T05:00:00.000Z","2019-02-19T05:00:00.000Z","2019-02-11T05:00:00.000Z","2019-02-06T05:00:00.000Z","2019-01-29T05:00:00.000Z","2019-01-24T05:00:00.000Z","2019-01-15T05:00:00.000Z","2019-01-08T05:00:00.000Z","2018-12-12T05:00:00.000Z","2018-12-04T05:00:00.000Z","2018-11-28T05:00:00.000Z","2018-11-15T05:00:00.000Z","2018-11-06T05:00:00.000Z","2018-10-31T04:00:00.000Z","2018-10-24T04:00:00.000Z","2018-10-17T04:00:00.000Z","2018-10-11T04:00:00.000Z","2018-10-01T04:00:00.000Z","2018-09-26T04:00:00.000Z","2018-09-18T04:00:00.000Z","2018-09-10T04:00:00.000Z","2018-09-03T04:00:00.000Z","2018-08-27T04:00:00.000Z"]
supporters = [210,210,210,210,210,210,209,208,208,207,206,206,205,203,203,202,201,200,199,200,198,198,198,192,191,191,190,190,189,188,187,187,186,186,185,182,182,182,182,182,178,178,178,173,172,172,172,173,171,170,170,169,169,168,167,164,164,164,164,163,162,153,153,154,151,150,149,149,147,147,139,138,138,138,138,134]
volunteers = [6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
leaders = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
total = [212,212,212,212,212,212,212,212,212,212,212,212,211,209,209,208,207,206,205,205,203,203,203,197,196,194,193,193,192,191,190,190,189,189,188,185,185,185,185,185,181,181,181,175,174,174,174,173,171,170,170,169,169,168,167,164,164,164,164,163,162,153,153,154,151,150,149,149,147,147,139,138,138,138,138,134]

# create a data frame with these arrays
df = pd.DataFrame({"dates" : dates, "supporters" : supporters, 'leaders' :leaders, "volunteers":volunteers, "total":total})
df['dates'] = pd.to_datetime(df['dates']).dt.date

#set index as date
df.set_index('dates', inplace=True)
df.index = pd.to_datetime(df.index)

# resample by quarters and print as csv
df.resample(rule='Q').last().to_csv("PA_quarters.csv")